
<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>DSRT Editor Full</title>
<style>
  body {
    margin: 0; font-family: Arial, sans-serif; background: #0b1420; color: #cce7e8;
  }
  header {
    display: flex; align-items: center; justify-content: space-between;
    background: #134254; padding: 10px 16px; font-weight: bold;
  }
  header button {
    background: transparent; border: none; color: #33cccc; font-size: 20px; cursor: pointer;
  }
  #canvas-area {
    margin: 16px auto; background: #222a33; border-radius: 8px; width: 90vw; max-width: 600px; height: 400px;
    display: flex; justify-content: center; align-items: center; color: #777;
  }
  #canvas-area img {
    max-width: 100%; max-height: 100%;
    filter: none;
    user-select: none;
    pointer-events: none;
  }
  .tabs {
    display: flex; justify-content: center; margin: 10px 0; gap: 12px;
  }
  .tab {
    padding: 8px 16px; background: #134254; border-radius: 20px; cursor: pointer;
    color: #33cccc; user-select: none; transition: background 0.3s;
  }
  .tab.active {
    background: #33cccc; color: #0b1420; font-weight: bold;
  }
  .panel {
    max-width: 600px; margin: 0 auto 20px auto; background: #0b1420cc; border-radius: 10px; padding: 12px;
  }
  /* Capsule Filters */
  .filter-categories, .filter-list {
    display: flex; overflow-x: auto; gap: 8px; padding: 4px 0;
  }
  .scroll-btn {
    background: #134254; color: #33cccc; border: none; font-weight: bold; cursor: pointer;
    width: 30px; border-radius: 4px;
    user-select: none;
  }
  .filter-categories button, .filter-list button {
    flex: 0 0 auto; background: #0b1420cc; border: none; color: #cce7e8; padding: 6px 12px;
    border-radius: 20px; cursor: pointer; user-select: none;
    transition: background 0.3s;
  }
  .filter-categories button.active, .filter-list button.active {
    background: #33cccc; color: #0b1420; font-weight: bold;
  }
  .filter-categories button:hover, .filter-list button:hover {
    background: #2aa9a9; color: #0b1420;
  }
  /* Manual Tools Accordion */
  .manual-tools-category {
    margin-bottom: 16px; border-bottom: 1px solid #224455;
  }
  .category-header {
    display: flex; justify-content: space-between; align-items: center;
    cursor: pointer; padding: 6px 12px; user-select: none;
    background: #134254; color: #33cccc; border-radius: 8px 8px 0 0;
  }
  .category-header:hover {
    background: #2aa9a9;
  }
  .category-header .arrow {
    font-weight: bold; font-size: 18px; user-select: none;
  }
  .tools-list {
    display: flex; flex-wrap: wrap; gap: 10px; padding: 10px 12px;
    background: #0b1420cc; border-radius: 0 0 8px 8px;
  }
  .tools-list button {
    flex: 1 0 30%; min-width: 120px;
    background: #0b1420cc; color: #cce7e8; border: none; border-radius: 25px;
    padding: 8px 14px; cursor: pointer; user-select: none;
    transition: background 0.3s;
  }
  .tools-list button:hover {
    background: #33cccc; color: #0b1420;
  }
  /* Slider */
  .slider-container {
    max-width: 600px; margin: 12px auto; text-align: center;
    color: #33cccc;
  }
  input[type=range] {
    -webkit-appearance: none; width: 80%; height: 8px; border-radius: 5px;
    background: #224455;
    outline: none;
    margin-top: 6px;
  }
  input[type=range]::-webkit-slider-thumb {
    -webkit-appearance: none; appearance: none; width: 18px; height: 18px;
    border-radius: 50%; background: #33cccc; cursor: pointer;
    border: 2px solid #0b1420;
  }
  /* Download Button */
  .download-container {
    max-width: 600px; margin: 0 auto 40px auto; text-align: right;
  }
  select, button.download-btn {
    background: #134254; border: none; color: #33cccc; padding: 8px 14px;
    border-radius: 8px; cursor: pointer; font-weight: bold;
  }
  select {
    margin-right: 12px;
  }
  @media (max-width: 640px) {
    .tools-list button {
      flex: 1 0 45%;
      min-width: auto;
    }
    .filter-categories button, .filter-list button {
      padding: 6px 10px;
      font-size: 14px;
    }
  }
</style>
</head>
<body>

<header>
  <button id="backBtn" aria-label="Back">&lt;</button>
  <div>Digital Smart Revise Technology</div>
  <button id="uploadBtn" aria-label="Upload Image">Upload Image</button>
</header>

<div id="canvas-area">
  <div>Canvas Image Placeholder</div>
</div>

<div class="tabs" role="tablist">
  <div class="tab active" data-tab="filters" role="tab" aria-selected="true" tabindex="0">Capsule Filters</div>
  <div class="tab" data-tab="manualtools" role="tab" aria-selected="false" tabindex="-1">Manual Tools</div>
</div>

<!-- Filters Panel -->
<div class="panel" id="filters-panel" role="tabpanel" tabindex="0">
  <div style="display:flex; align-items:center; gap:8px;">
    <button class="scroll-btn" id="catScrollLeft" aria-label="Scroll Categories Left">&lt;</button>
    <div class="filter-categories" id="filterCategories" tabindex="0" aria-label="Filter Categories">
      <!-- Categories inserted here -->
    </div>
    <button class="scroll-btn" id="catScrollRight" aria-label="Scroll Categories Right">&gt;</button>
  </div>

  <div style="display:flex; align-items:center; gap:8px; margin-top:10px;">
    <button class="scroll-btn" id="filterScrollLeft" aria-label="Scroll Filters Left">&lt;</button>
    <div class="filter-list" id="filterList" tabindex="0" aria-label="Filters">
      <!-- Filters inserted here -->
    </div>
    <button class="scroll-btn" id="filterScrollRight" aria-label="Scroll Filters Right">&gt;</button>
  </div>

  <div class="slider-container" id="filterSliderContainer" style="display:none;">
    <label for="filterSlider">Intensity:</label><br/>
    <input type="range" id="filterSlider" min="0" max="100" value="50" aria-valuemin="0" aria-valuemax="100" aria-valuenow="50" />
  </div>
</div>

<!-- Manual Tools Panel -->
<div class="panel" id="manualtools-panel" style="display:none;" role="tabpanel" tabindex="0">
  <div class="manual-tools-category">
    <div class="category-header" tabindex="0">
      Basic <span class="arrow">▼</span>
    </div>
    <div class="tools-list">
      <button>Crop</button>
      <button>Resize</button>
      <button>Rotate</button>
      <button>Flip Horizontal</button>
      <button>Flip Vertical</button>
    </div>
  </div>
  <div class="manual-tools-category">
    <div class="category-header" tabindex="0">
      Advanced <span class="arrow">▼</span>
    </div>
    <div class="tools-list">
      <button>Clone Stamp</button>
      <button>Spot Removal</button>
      <button>Healing Brush</button>
      <button>Sharpen</button>
      <button>Blur</button>
      <button>Color Correction</button>
    </div>
  </div>
  <div class="manual-tools-category">
    <div class="category-header" tabindex="0">
      Pro <span class="arrow">▼</span>
    </div>
    <div class="tools-list">
      <button>Dodge & Burn</button>
      <button>Noise Reduction</button>
      <button>Lens Correction</button>
      <button>Perspective Warp</button>
      <button>Batch Processing</button>
    </div>
  </div>
  <div class="slider-container" id="toolsSliderContainer" style="display:none;">
    <label for="toolsSlider">Intensity:</label><br/>
    <input type="range" id="toolsSlider" min="0" max="100" value="50" />
  </div>
</div>

<div class="download-container">
  <select id="downloadRes" aria-label="Pilih resolusi download">
    <option value="640">Kecil (640x480)</option>
    <option value="1280" selected>Sedang (1280x960)</option>
    <option value="1920">Besar (1920x1440)</option>
    <option value="original">Asli (Original Size)</option>
  </select>
  <button class="download-btn" id="downloadBtn">Download</button>
</div>

<script>
  const filterCategories = ['Normal', 'Hue', 'Blur', 'Sepia', 'BMW', 'Vintage'];
  const filters = {
    'Normal': ['Normal', 'Grayscale', 'Sepia', 'Blur Low', 'Brightness High', 'Contrast', 'Invert'],
    'Hue': ['Hue +10', 'Hue +20', 'Hue -10', 'Hue -20'],
    'Blur': ['Blur Low', 'Blur Medium', 'Blur High'],
    'Sepia': ['Sepia Light', 'Sepia Medium', 'Sepia Strong'],
    'BMW': ['BMW Classic', 'BMW Sport', 'BMW Retro'],
    'Vintage': ['Vintage Warm', 'Vintage Cool']
  };

  const filtersWithIntensity = ['Blur Low', 'Blur Medium', 'Blur High', 'Brightness High', 'Contrast', 'Hue +10', 'Hue +20', 'Hue -10', 'Hue -20', 'Sepia Light', 'Sepia Medium', 'Sepia Strong'];

  const filterCategoriesDiv = document.getElementById('filterCategories');
  const filterListDiv = document.getElementById('filterList');
  const filterSliderContainer = document.getElementById('filterSliderContainer');
  const filterSlider = document.getElementById('filterSlider');

  const tabs = document.querySelectorAll('.tab');
  const filtersPanel = document.getElementById('filters-panel');
  const manualtoolsPanel = document.getElementById('manualtools-panel');

  const canvasArea = document.getElementById('canvas-area');

  // Img element for canvas area
  let img = document.createElement('img');
  img.style.maxWidth = '100%';
  img.style.maxHeight = '100%';
  canvasArea.innerHTML = '';
  canvasArea.appendChild(img);

  let currentFilter = 'none';
  let currentFilterValue = 50;

  // Render filter categories buttons
  function renderFilterCategories() {
    filterCategoriesDiv.innerHTML = '';
    filterCategories.forEach(cat => {
      const btn = document.createElement('button');
      btn.textContent = cat;
      btn.dataset.cat = cat;
      if (cat === filterCategories[0]) btn.classList.add('active');
      btn.addEventListener('click', () => {
        document.querySelectorAll('#filterCategories button').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        renderFilters(cat);
      });
      filterCategoriesDiv.appendChild(btn);
    });
  }

  // Render filters buttons for selected category
  function renderFilters(category) {
    filterListDiv.innerHTML = '';
    const fltrs = filters[category] || [];
    fltrs.forEach(flt => {
      const btn = document.createElement('button');
      btn.textContent = flt;
      btn.dataset.filter = flt;
      btn.addEventListener('click', () => {
        applyFilter(flt, 50);
        // Show slider if filter supports intensity
        if (filtersWithIntensity.includes(flt)) {
          filterSliderContainer.style.display = 'block';
          filterSlider.value = 50;
        } else {
          filterSliderContainer.style.display = 'none';
        }
        // Highlight active filter
        document.querySelectorAll('#filterList button').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
      });
      filterListDiv.appendChild(btn);
    });
  }

  // Apply CSS filter to img element
  function applyFilter(filterName, intensity = 50) {
    currentFilter = filterName;
    currentFilterValue = intensity;
    let cssFilter = 'none';

    switch (filterName) {
      case 'Blur Low':
        cssFilter = `blur(${(intensity / 50)}px)`;
        break;
      case 'Blur Medium':
        cssFilter = `blur(${(intensity / 25)}px)`;
        break;
      case 'Blur High':
        cssFilter = `blur(${(intensity / 15)}px)`;
        break;
      case 'Brightness High':
        cssFilter = `brightness(${1 + intensity / 100})`;
        break;
      case 'Contrast':
        cssFilter = `contrast(${1 + intensity / 100})`;
        break;
      case 'Grayscale':
        cssFilter = `grayscale(${intensity / 100})`;
        break;
      case 'Sepia':
      case 'Sepia Light':
      case 'Sepia Medium':
      case 'Sepia Strong':
        cssFilter = `sepia(${intensity / 100})`;
        break;
      case 'Invert':
        cssFilter = `invert(${intensity / 100})`;
        break;
      case 'Hue +10':
      case 'Hue +20':
      case 'Hue -10':
      case 'Hue -20':
        let deg = parseInt(filterName.match(/[-+]?\d+/)[0]);
        cssFilter = `hue-rotate(${deg}deg)`;
        break;
      default:
        cssFilter = 'none';
    }
    img.style.filter = cssFilter;
  }

  // Scroll buttons for categories and filters
  document.getElementById('catScrollLeft').onclick = () => {
    filterCategoriesDiv.scrollBy({left: -100, behavior: 'smooth'});
  };
  document.getElementById('catScrollRight').onclick = () => {
    filterCategoriesDiv.scrollBy({left: 100, behavior: 'smooth'});
  };
  document.getElementById('filterScrollLeft').onclick = () => {
    filterListDiv.scrollBy({left: -100, behavior: 'smooth'});
  };
  document.getElementById('filterScrollRight').onclick = () => {
    filterListDiv.scrollBy({left: 100, behavior: 'smooth'});
  };

  // Tabs switching
  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      tabs.forEach(t => {
        t.classList.remove('active');
        t.setAttribute('aria-selected', 'false');
        t.tabIndex = -1;
      });
      tab.classList.add('active');
      tab.setAttribute('aria-selected', 'true');
      tab.tabIndex = 0;

      if (tab.dataset.tab === 'filters') {
        filtersPanel.style.display = 'block';
        manualtoolsPanel.style.display = 'none';
        filterSliderContainer.style.display = filterSliderContainer.style.display === 'block' ? 'block' : 'none';
        document.getElementById('toolsSliderContainer').style.display = 'none';
      } else {
        filtersPanel.style.display = 'none';
        manualtoolsPanel.style.display = 'block';
        document.getElementById('toolsSliderContainer').style.display = 'none';
        filterSliderContainer.style.display = 'none';
      }
    });
  });

  // Manual Tools Accordion all open by default and toggle on click
  document.querySelectorAll('.manual-tools-category').forEach(cat => {
    const header = cat.querySelector('.category-header');
    const toolsList = cat.querySelector('.tools-list');
    toolsList.style.display = 'flex';
    header.querySelector('.arrow').textContent = '▼';

    header.addEventListener('click', () => {
      if (toolsList.style.display === 'none') {
        toolsList.style.display = 'flex';
        header.querySelector('.arrow').textContent = '▼';
      } else {
        toolsList.style.display = 'none';
        header.querySelector('.arrow').textContent = '►';
      }
    });
  });

  // Manual Tools button click
  document.querySelectorAll('.tools-list button').forEach(btn => {
    btn.addEventListener('click', () => {
      alert(`Apply tool: ${btn.textContent}`); // Ganti dengan fungsi nyata
      // Show slider if tool supports intensity (contoh)
      const toolsWithIntensity = ['Blur', 'Sharpen', 'Dodge & Burn', 'Noise Reduction'];
      if (toolsWithIntensity.includes(btn.textContent)) {
        document.getElementById('toolsSliderContainer').style.display = 'block';
        document.getElementById('toolsSlider').value = 50;
      } else {
        document.getElementById('toolsSliderContainer').style.display = 'none';
      }
    });
  });

  // Slider update filter intensity
  filterSlider.addEventListener('input', e => {
    applyFilter(currentFilter, e.target.value);
